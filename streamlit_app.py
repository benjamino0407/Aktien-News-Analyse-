# -*- coding: utf-8 -*-
"""Untitled2.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1H15kMSblo4sjVALTraZmoZkJVJZFjem_

# Neuer Abschnitt
"""

# ğŸ“¦ Installation (nur 1x nÃ¶tig)

# ğŸ“š Imports
from transformers import pipeline
from newsapi import NewsApiClient

# ğŸ”‘ News API-Key (deiner!)
newsapi = NewsApiClient(api_key="58ea5651ae5244929c604838e6f88a9b")

# ğŸ“¥ News abrufen
def get_news(query):
    all_articles = newsapi.get_everything(q=query, language='de', sort_by='publishedAt', page_size=5)
    return [(a['title'], a.get('description', '')) for a in all_articles['articles']]

# ğŸ§  Kostenloses Modell fÃ¼r Sentiment
sentiment_analyzer = pipeline("sentiment-analysis", model="cardiffnlp/twitter-roberta-base-sentiment")

# ğŸ“Š Ergebnisse auswerten
def analyze_news(titel, beschreibung):
    text = titel + ". " + beschreibung
    result = sentiment_analyzer(text[:512])[0]  # max. 512 Zeichen
    return result['label'], round(result['score'], 2)



    # ğŸ§  Stimmung Ã¼bersetzen und in Empfehlung umwandeln
def label_to_text(label):
    if label == "LABEL_2":
        return "âœ… POSITIV â€“ Kaufen"
    elif label == "LABEL_1":
        return "ğŸ¤” Neutral â€“ Beobachten"
    elif label == "LABEL_0":
        return "âŒ Negativ â€“ Nicht kaufen"
    else:
        return "Unklar"

# ğŸš€ Test mit Thema "Tesla"
thema = "Tesla"
news = get_news(thema)

# âœ¨ Ausgabe mit Empfehlung
for titel, beschreibung in news:
    label, score = analyze_news(titel, beschreibung)
    empfehlung = label_to_text(label)
    print("ğŸ“°", titel)
    print("ğŸ“Š Stimmung:", empfehlung, f"(Score: {score})")
    print("-" * 60)
